--- Jamfile.v2	2017-10-12 02:38:09.133026300 +0300
+++ Jamfile_new.v2	2017-10-14 20:11:00.022055800 +0300
@@ -24,6 +24,16 @@
     {
     	result = <search>$(ICU_PATH)/bin <search>$(ICU_PATH)/lib ;
     }
+	
+#<toolset>msvc:<linkflags>advapi32.lib
+#<toolset>gcc:<cxxflags>-std=c++11
+#<toolset>gcc <link>static:<linkflags>-ldl
+
+	if <toolset>msvc in $(properties)
+	{
+    	result = $(result) <linkflags>advapi32.lib ;
+    }
+	
     return $(result) ;
 }
 
@@ -49,48 +59,94 @@
    else
    {
       lib icuuc : :                                                               <runtime-link>shared <conditional>@path_options ;
-      lib icuuc : : <toolset>msvc                     <variant>debug <name>icuucd <runtime-link>shared <conditional>@path_options ;
-      lib icuuc : : <toolset>intel <target-os>windows <variant>debug <name>icuucd <runtime-link>shared <conditional>@path_options ;
       lib icuuc : :                                                  <name>sicuuc <runtime-link>static <conditional>@path_options ;
-      lib icuuc : : <toolset>msvc                     <variant>debug <name>sicuucd <runtime-link>static <conditional>@path_options ;
+      lib icuuc : : <toolset>intel <target-os>windows <variant>debug <name>icuucd <runtime-link>shared <conditional>@path_options ;
       lib icuuc : : <toolset>intel <target-os>windows <variant>debug <name>sicuucd <runtime-link>static <conditional>@path_options ;
+	  
+      lib icuuc : : <toolset>msvc                                    <name>sicuuc <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuuc : : <toolset>msvc                                    <name>icuuc <runtime-link>shared <link>shared <conditional>@path_options ;	  
+      lib icuuc : : <toolset>msvc                     <variant>debug <name>sicuucd <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuuc : : <toolset>msvc                     <variant>debug <name>icuucd <runtime-link>shared <link>shared <conditional>@path_options ;
+	  
+      lib icuuc : : <toolset>darwin                                  <name>icuuc <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuuc : : <toolset>darwin                                  <name>icuuc <runtime-link>shared <link>shared <conditional>@path_options ;	  
+      lib icuuc : : <toolset>darwin                   <variant>debug <name>icuuc <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuuc : : <toolset>darwin                   <variant>debug <name>icuuc <runtime-link>shared <link>shared <conditional>@path_options ;
+	  
+      lib icuuc : : <toolset>gcc                                     <name>icuuc <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuuc : : <toolset>gcc                                     <name>icuuc <runtime-link>shared <link>shared <conditional>@path_options ;	  
+      lib icuuc : : <toolset>gcc                      <variant>debug <name>icuuc <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuuc : : <toolset>gcc                      <variant>debug <name>icuuc <runtime-link>shared <link>shared <conditional>@path_options ;
+	  
       lib icuuc : : <name>this_is_an_invalid_library_name ;
-
+	  
+	  
       lib icudt : : <name>icudata                                   <runtime-link>shared <conditional>@path_options ;
-      lib icudt : : <name>icudt   <toolset>msvc                     <runtime-link>shared <conditional>@path_options ;
       lib icudt : : <name>icudt   <toolset>intel <target-os>windows <runtime-link>shared <conditional>@path_options ;
       lib icudt : : <name>sicudata                                   <runtime-link>static <conditional>@path_options ;
-      lib icudt : : <name>sicudt   <toolset>msvc                     <runtime-link>static <conditional>@path_options ;
       lib icudt : : <name>sicudt   <toolset>intel <target-os>windows <runtime-link>static <conditional>@path_options ;
+	  
+      lib icudt : : <toolset>msvc                                    <name>sicudt <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icudt : : <toolset>msvc                                    <name>icudt <runtime-link>shared <link>shared <conditional>@path_options ;	  
+      lib icudt : : <toolset>msvc                     <variant>debug <name>sicudtd <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icudt : : <toolset>msvc                     <variant>debug <name>icudtd <runtime-link>shared <link>shared <conditional>@path_options ;
+
+      lib icudt : : <toolset>darwin                                  <name>icudata <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icudt : : <toolset>darwin                                  <name>icudata <runtime-link>shared <link>shared <conditional>@path_options ;	  
+      lib icudt : : <toolset>darwin                   <variant>debug <name>icudata <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icudt : : <toolset>darwin                   <variant>debug <name>icudata <runtime-link>shared <link>shared <conditional>@path_options ;
+
+      lib icudt : : <toolset>gcc                                     <name>icudata <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icudt : : <toolset>gcc                                     <name>icudata <runtime-link>shared <link>shared <conditional>@path_options ;	  
+      lib icudt : : <toolset>gcc                      <variant>debug <name>icudata <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icudt : : <toolset>gcc                      <variant>debug <name>icudata <runtime-link>shared <link>shared <conditional>@path_options ;
+	  
       lib icudt : : <name>this_is_an_invalid_library_name ;
-
+	  
+	  
       lib icuin : :                                                    <name>icui18n <runtime-link>shared <conditional>@path_options ;
-      lib icuin : : <toolset>msvc                     <variant>debug   <name>icuind  <runtime-link>shared <conditional>@path_options ;
-      lib icuin : : <toolset>msvc                                      <name>icuin   <runtime-link>shared <conditional>@path_options ;
       lib icuin : : <toolset>intel <target-os>windows <variant>debug   <name>icuind  <runtime-link>shared <conditional>@path_options ;
       lib icuin : : <toolset>intel <target-os>windows                  <name>icuin   <runtime-link>shared <conditional>@path_options ;
       lib icuin : :                                                    <name>sicui18n <runtime-link>static <conditional>@path_options ;
-      lib icuin : : <toolset>msvc                     <variant>debug   <name>sicuind  <runtime-link>static <conditional>@path_options ;
-      lib icuin : : <toolset>msvc                                      <name>sicuin   <runtime-link>static <conditional>@path_options ;
       lib icuin : : <toolset>intel <target-os>windows <variant>debug   <name>sicuind  <runtime-link>static <conditional>@path_options ;
       lib icuin : : <toolset>intel <target-os>windows                  <name>sicuin   <runtime-link>static <conditional>@path_options ;
+      
+      lib icuin : : <toolset>msvc                                    <name>sicuin <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuin : : <toolset>msvc                                    <name>icuin <runtime-link>shared <link>shared <conditional>@path_options ;	  
+      lib icuin : : <toolset>msvc                     <variant>debug <name>sicuind <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuin : : <toolset>msvc                     <variant>debug <name>icuind <runtime-link>shared <link>shared <conditional>@path_options ;
+
+      lib icuin : : <toolset>darwin                                  <name>icui18n <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuin : : <toolset>darwin                                  <name>icui18n <runtime-link>shared <link>shared <conditional>@path_options ;	  
+      lib icuin : : <toolset>darwin                   <variant>debug <name>icui18n <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuin : : <toolset>darwin                   <variant>debug <name>icui18n <runtime-link>shared <link>shared <conditional>@path_options ;
+	  
+      lib icuin : : <toolset>gcc                                     <name>icui18n <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuin : : <toolset>gcc                                     <name>icui18n <runtime-link>shared <link>shared <conditional>@path_options ;	  
+      lib icuin : : <toolset>gcc                      <variant>debug <name>icui18n <runtime-link>shared <link>static <conditional>@path_options ;
+      lib icuin : : <toolset>gcc                      <variant>debug <name>icui18n <runtime-link>shared <link>shared <conditional>@path_options ;
+	  
       lib icuin : : <name>this_is_an_invalid_library_name ;
 
       ICU_OPTS = 
          <include>$(ICU_PATH)/include 
-         <runtime-link>shared:<library>icuuc/<link>shared
-         <runtime-link>shared:<library>icudt/<link>shared
-         <runtime-link>shared:<library>icuin/<link>shared
+         <runtime-link>shared:<library>icuuc
+         <runtime-link>shared:<library>icudt
+         <runtime-link>shared:<library>icuin
          <runtime-link>static:<library>icuuc
          <runtime-link>static:<library>icudt
          <runtime-link>static:<library>icuin
          <define>BOOST_HAS_ICU=1 
-         <runtime-link>static:<define>U_STATIC_IMPLEMENTATION=1
+         <link>static:<define>U_STATIC_IMPLEMENTATION=1
+		 <toolset>msvc:<linkflags>advapi32.lib
+		 <toolset>gcc:<cxxflags>-std=c++11
+		 <toolset>gcc <link>static:<linkflags>-ldl
          ;
    }
 
 }
 
+
 unit-test has_icu : has_icu_test.cpp : $(ICU_OPTS) ;
 explicit has_icu ;
 
